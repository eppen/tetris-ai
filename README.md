# 俄罗斯方块游戏 - AI玩家版本

## 🎮 游戏简介
这是一个带有AI玩家功能的俄罗斯方块游戏。你可以手动玩游戏，也可以让AI自动玩！支持**最高分本地保存**，得分创新高会自动写入文件。

## 🚀 如何运行

### 1. 依赖
```bash
pip install pygame
```

### 2. 启动游戏
```bash
cd tetris
python tetris.py
```

### 3. 游戏控制

#### 基本控制
- **← →** : 左右移动方块
- **↑** : 旋转方块
- **↓** : 加速下落
- **空格** : 硬降落（直接落到底部）
- **R** : 重新开始游戏
- **ESC** : 退出游戏

#### AI控制
- **A** : 切换AI模式（启用/禁用）

## 📊 最高分保存
- 最高分保存在游戏目录下的 `tetris_highscore.txt`（打包后为 `~/.tetris_ai/tetris_highscore.txt`）
- 游戏结束时若**得分创新高**，会弹出输入框让你**输入名字**，与分数一起保存
- 侧边栏实时显示当前**最高分**及记录保持者名字（黄色）
- 结束画面会显示「得分新高! 已保存 - 你的名字」
- 重新开始游戏不会清除已保存的最高分

## 🤖 AI玩家功能

### AI算法特点
1. **位置评估** - AI会评估每个可能位置的优劣
2. **决策系统** - 选择最佳放置位置
3. **路径规划** - 自动计算移动和旋转步骤
4. **实时控制** - 自动执行移动计划

### AI评估标准
AI根据以下因素评估位置：
- **高度惩罚** - 鼓励放在底部
- **空洞惩罚** - 避免创建空洞
- **行完整度奖励** - 鼓励完成整行
- **凹凸不平惩罚** - 保持棋盘表面平整

### AI状态显示
- 侧边栏会显示AI状态（启用/禁用）
- AI启用时显示绿色"AI: 启用"
- AI禁用时显示红色"AI: 禁用"

## 📈 游戏特性

### 计分系统
- 消除1行: 100分 × 等级
- 消除2行: 300分 × 等级
- 消除3行: 500分 × 等级
- 消除4行（Tetris!）: 800分 × 等级

### 等级系统
- 每消除10行升一级
- 等级越高，方块下落速度越快
- 最高速度限制为0.05秒/格

## 🛠️ 技术实现

### 主要类
1. **Tetromino** - 俄罗斯方块单个方块
2. **TetrisGame** - 游戏主类
3. **TetrisAI** - AI玩家类

### AI算法流程
1. 遍历所有可能的旋转状态（0-3次）
2. 遍历所有可能的水平位置
3. 计算每个位置能下落到的最大高度
4. 评估每个位置的得分
5. 选择得分最低（最优）的位置
6. 生成移动计划并执行

## 📝 更新日志
- **v1.0** - 初始版本，添加基础AI功能
- **v1.1** - 优化评估函数，添加测试脚本
- **v1.2** - AI 启用时考虑下一个方块（look-ahead），决策更优
- **v1.3** - 最高分本地保存：得分创新高自动写入，侧栏与结束画面显示最高分/新高提示
- **v1.4** - 破纪录时可输入名字，与分数一并保存并在侧栏与结束画面显示

## 🎉 享受游戏！
按 **A** 键切换AI模式，挑战你的最高分吧！
